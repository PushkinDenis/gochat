<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <title>WebSocket Чат</title>
  </head>
  <body>
    <h1>Чат на WebSocket</h1>
    <form onsubmit="sendMessage(); return false;">
      <input
        type="text"
        name="input"
        id="messageInput"
        placeholder="Введите сообщение"
      />
      <button type="submit">Отправить</button>
    </form>

    <script>
      const socket = new WebSocket("ws://localhost:8080/ws");

      socket.onopen = () => {
        console.log("Соединение открыто");
        addToChatLog("Соединение открыто");
      };

      socket.onmessage = (event) => {
        console.log("Ответ сервера:", event.data);
        addToChatLog(event.data);
      };

      function sendMessage() {
        const input = document.getElementById("messageInput");
        const message = input.value.trim();
        if (message) {
          socket.send(JSON.stringify(message));
          addToChatLog("Вы: " + message);
          input.value = "";
        }
      }

      function addToChatLog(message) {
        const log = document.getElementById("chatLog");
        log.innerHTML += `<p>${message}</p>`;
      }
    </script>

    <div id="chatLog"></div>

    <script>
      const socket = new WebSocket("ws://localhost:8080/ws");

      socket.onopen = () => {
        console.log("Соединение открыто");
        addToChatLog("Соединение открыто");
      };

      socket.onmessage = (event) => {
        console.log("Ответ сервера:", event.data);
        addToChatLog(event.data);
      };

      function sendMessage() {
        const input = document.getElementById("messageInput");
        const message = input.value;
        if (message) {
          socket.send(JSON.stringify(message));
          input.value = "";
          addToChatLog("Вы: " + message);
        }
      }

      function addToChatLog(message) {
        const log = document.getElementById("chatLog");
        log.innerHTML += `<p>${message}</p>`;
      }
    </script>
  </body>
</html>
